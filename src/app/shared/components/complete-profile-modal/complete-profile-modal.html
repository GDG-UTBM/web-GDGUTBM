<div class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"
     (click)="closeModal()">
  <div class="bg-white/95 rounded-r24 w-full max-w-md p-6 md:p-7 animate-scale-in border border-gdg-line shadow-2xl"
       (click)="$event.stopPropagation()">
    <div class="h-1.5 rounded-full bg-gradient-to-r from-gdg-blue to-blue-400 mb-5"></div>
    <div class="flex justify-between items-center mb-6">
      <h3 class="text-xl font-semibold">
        {{ languageService.isFrench() ? 'Complétez votre profil' : 'Complete your profile' }}
      </h3>
      <button (click)="closeModal()" class="text-gdg-muted hover:text-gdg-text">
        ✕
      </button>
    </div>

    <p class="text-gdg-muted mb-6">
      {{ languageService.isFrench()
      ? 'Veuillez compléter votre profil pour accéder à toutes les fonctionnalités.'
      : 'Please complete your profile to access all features.'
      }}
    </p>

    <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" class="space-y-4">
      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-gdg-text mb-1">
            {{ languageService.isFrench() ? 'Prénom *' : 'First name *' }}
          </label>
          <input type="text" formControlName="first_name"
                 class="w-full border border-gdg-line rounded-r4 px-3 py-2">
        </div>
        <div>
          <label class="block text-sm font-medium text-gdg-text mb-1">
            {{ languageService.isFrench() ? 'Nom *' : 'Last name *' }}
          </label>
          <input type="text" formControlName="last_name"
                 class="w-full border border-gdg-line rounded-r4 px-3 py-2">
        </div>
      </div>

      <div>
        <label class="block text-sm font-medium text-gdg-text mb-2">
          {{ languageService.isFrench() ? 'Vous êtes *' : 'You are *' }}
        </label>
        <div class="flex space-x-4">
          <label class="flex items-center">
            <input type="radio" formControlName="role" value="student" class="mr-2">
            <span>{{ languageService.isFrench() ? 'Étudiant' : 'Student' }}</span>
          </label>
          <label class="flex items-center">
            <input type="radio" formControlName="role" value="professional" class="mr-2">
            <span>{{ languageService.isFrench() ? 'Professionnel' : 'Professional' }}</span>
          </label>
        </div>
      </div>

      @if (selectedRole() === 'student') {
        <div>
          <label class="block text-sm font-medium text-gdg-text mb-1">
            {{ languageService.isFrench() ? 'École *' : 'School *' }}
          </label>
          <input type="text" formControlName="school"
                 class="w-full border border-gdg-line rounded-r4 px-3 py-2">
        </div>
        <div>
          <label class="block text-sm font-medium text-gdg-text mb-1">
            {{ languageService.isFrench() ? 'Niveau d'étude *' : 'Study level *' }}
          </label>
          <select formControlName="study_level"
                  class="w-full border border-gdg-line rounded-r4 px-3 py-2">
            <option value="">{{ languageService.isFrench() ? 'Sélectionnez' : 'Select' }}</option>
            <option value="licence">Licence</option>
            <option value="master">Master</option>
            <option value="doctorat">Doctorat</option>
          </select>
        </div>
      }

      @if (selectedRole() === 'professional') {
        <div>
          <label class="block text-sm font-medium text-gdg-text mb-1">
            {{ languageService.isFrench() ? 'Entreprise' : 'Company' }}
          </label>
          <input type="text" formControlName="company"
                 class="w-full border border-gdg-line rounded-r4 px-3 py-2">
        </div>
      }

      @if (errorMessage()) {
        <p class="text-red-500 text-sm">{{ errorMessage() }}</p>
      }

      <button type="submit" [disabled]="isLoading()"
              class="btn-primary w-full">
        @if (isLoading()) {
          <span>{{ languageService.isFrench() ? 'Enregistrement...' : 'Saving...' }}</span>
        } @else {
          <span>{{ languageService.isFrench() ? 'Enregistrer' : 'Save' }}</span>
        }
      </button>
    </form>
  </div>
</div>
