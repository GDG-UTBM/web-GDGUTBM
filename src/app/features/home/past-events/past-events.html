<section class="section section-soft events-2026" id="evenements">
  <div class="container-custom">
    <header class="events-head">
      <h2 class="events-title">{{ languageService.isFrench() ? 'Événements passés' : 'Past events' }}</h2>
    </header>

    <div class="events-carousel" aria-label="Carrousel des événements passés">
      <button class="events-nav events-nav--prev" type="button" aria-label="Événement précédent" (click)="goPrev()">
        ‹
      </button>

      <div class="events-viewport" #eventsViewport>
        <div class="events-track" #eventsTrack>
          @for (event of displayedEvents(); track event.id) {
            <article class="event-slide">
              <div class="event-card2">
                <div class="event-media">
                  @if (event.image_url) {
                    <img [src]="event.image_url" [alt]="event.title_fr">
                  } @else {
                    <div class="event-media-fallback">GDG</div>
                  }
                </div>
                <div class="event-body">
                  <h3 class="event-title2">{{ languageService.isFrench() ? event.title_fr : event.title_en }}</h3>
                  <p class="event-desc2">{{ languageService.isFrench() ? event.description_fr : event.description_en }}</p>
                  <p class="event-meta2">
                    {{ event.date | date:'dd/MM/yyyy' }} · {{ event.date | date:'HH:mm' }} · {{ event.location || (languageService.isFrench() ? 'Lieu à préciser' : 'Location TBA') }}
                    @if (event.partner) { · {{ event.partner }} }
                    @if (eventLink(event)) { · <a [href]="eventLink(event)" target="_blank" rel="noopener">{{ languageService.isFrench() ? 'Lien' : 'Link' }}</a> }
                    @else { · {{ languageService.isFrench() ? 'Lien : -' : 'Link: -' }} }
                  </p>
                  <div class="event-links">
                    <a [routerLink]="['/events', event.id]" class="btn-secondary">
                      {{ languageService.isFrench() ? 'Voir plus' : 'Learn more' }}
                    </a>
                    @if (getEventStatus(event) === 'upcoming') {
                      <button class="btn-primary" (click)="openParticipation(event)">
                        {{ languageService.isFrench() ? 'Participer' : 'Participate' }}
                      </button>
                    } @else {
                      <button class="btn-secondary" (click)="openEventDetail(event)">
                        {{ languageService.isFrench() ? 'Aperçu' : 'Preview' }}
                      </button>
                    }
                  </div>
                </div>
              </div>
            </article>
          }
        </div>
      </div>

      <button class="events-nav events-nav--next" type="button" aria-label="Événement suivant" (click)="goNext()">
        ›
      </button>

      <div class="events-footer">
        <button class="btn-primary events-all" (click)="goToAllEvents()">
          {{ languageService.isFrench() ? 'Découvrir tous les événements' : 'Discover all events' }}
        </button>
      </div>
    </div>
  </div>
</section>

@if (selectedEvent()) {
  <app-event-detail-modal
    [eventId]="selectedEvent()!.id"
    (close)="closeEventDetail()">
  </app-event-detail-modal>
}

@if (showParticipationModal() && selectedParticipationEvent()) {
  <app-participation-modal
    [eventId]="selectedParticipationEvent()!.id"
    [eventTitle]="languageService.isFrench() ? selectedParticipationEvent()!.title_fr : selectedParticipationEvent()!.title_en"
    (close)="closeParticipation()">
  </app-participation-modal>
}
